"use strict";(self.webpackChunksaurus=self.webpackChunksaurus||[]).push([[9909],{14439:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"developer-guide/projects/osbuild/modules/stages/org.osbuild.selinux","title":"org.osbuild.selinux","description":"\x3c!--","source":"@site/docs/developer-guide/02-projects/osbuild/modules/stages/org.osbuild.selinux.md","sourceDirName":"developer-guide/02-projects/osbuild/modules/stages","slug":"/developer-guide/projects/osbuild/modules/stages/org.osbuild.selinux","permalink":"/docs/developer-guide/projects/osbuild/modules/stages/org.osbuild.selinux","draft":false,"unlisted":false,"editUrl":"https://github.com/osbuild/osbuild/tree/main/stages/org.osbuild.selinux.meta.json","tags":[],"version":"current","frontMatter":{"custom_edit_url":"https://github.com/osbuild/osbuild/tree/main/stages/org.osbuild.selinux.meta.json"},"sidebar":"developer","previous":{"title":"org.osbuild.selinux.config","permalink":"/docs/developer-guide/projects/osbuild/modules/stages/org.osbuild.selinux.config"},"next":{"title":"org.osbuild.sfdisk","permalink":"/docs/developer-guide/projects/osbuild/modules/stages/org.osbuild.sfdisk"}}');var o=s(74848),i=s(28453);const r={custom_edit_url:"https://github.com/osbuild/osbuild/tree/main/stages/org.osbuild.selinux.meta.json"},l="org.osbuild.selinux",d={},a=[{value:"Schema 1",id:"schema-1",level:2},{value:"Schema 2",id:"schema-2",level:2}];function u(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"orgosbuildselinux",children:"org.osbuild.selinux"})}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Set SELinux file contexts"})}),"\n",(0,o.jsxs)(t.p,{children:["Sets correct SELinux labels for every file in the tree or on mount, according to\nthe SELinux policy.\nUses the host's ",(0,o.jsx)(t.code,{children:"setfiles"})," program and the tree's ",(0,o.jsx)(t.code,{children:"file_contexts"}),', usually\n/etc/selinux/<SELINUXTYPE>/contexts/files/file_contexts\nwhere <SELINUXTYPE> is the value set in /etc/selinux/config (usually "targeted"\nbut may also be "minimum" or "mls").\nThis stage may set or modify xattrs for any file inside the tree, but should\nnot need to create files, modify file contents, or read any files other than\n',(0,o.jsx)(t.code,{children:"file_contexts"}),".\nThis stage should run after all other stages that create (or move) files, since\nlabels for newly-created files are determined by the host's SELinux policy and\nmay not match the tree's policy."]}),"\n",(0,o.jsx)(t.h2,{id:"schema-1",children:"Schema 1"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-json",children:"{}\n"})}),"\n",(0,o.jsx)(t.h2,{id:"schema-2",children:"Schema 2"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-json",children:'{\n  "options": {\n    "additionalProperties": false,\n    "anyOf": [\n      {\n        "required": [\n          "file_contexts"\n        ]\n      },\n      {\n        "required": [\n          "labels"\n        ]\n      }\n    ],\n    "properties": {\n      "target": {\n        "type": "string",\n        "description": "Target path in the tree or on a mount",\n        "pattern": "^mount://[^/]+/|^tree:///",\n        "default": "tree:///"\n      },\n      "file_contexts": {\n        "description": "Path to the active SELinux policy\'s `file_contexts`. Supports `tree://`, `mount://`, and `input://` schemes. Plain paths imply `tree://`.",\n        "type": "string"\n      },\n      "exclude_paths": {\n        "type": "array",\n        "description": "Paths to exclude when setting labels via file_contexts",\n        "items": {\n          "type": "string"\n        }\n      },\n      "labels": {\n        "type": "object",\n        "description": "Labels to set of the specified files or folders",\n        "items": {\n          "type": "object"\n        }\n      },\n      "force_autorelabel": {\n        "type": "boolean",\n        "description": "Do not use. Forces auto-relabelling on first boot. Affects target\'s root or tree:/// by default",\n        "default": false\n      }\n    }\n  },\n  "devices": {\n    "type": "object",\n    "additionalProperties": true\n  },\n  "mounts": {\n    "type": "array"\n  },\n  "inputs": {\n    "type": "object",\n    "additionalProperties": true\n  }\n}\n'})})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>l});var n=s(96540);const o={},i=n.createContext(o);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);