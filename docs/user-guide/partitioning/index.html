<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user-guide/partitioning" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Partitioning | Image Builder</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://osbuild.org/docs/user-guide/partitioning/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Partitioning | Image Builder"><meta data-rh="true" name="description" content="General principles"><meta data-rh="true" property="og:description" content="General principles"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://osbuild.org/docs/user-guide/partitioning/"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/user-guide/partitioning/" hreflang="en"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/user-guide/partitioning/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2d858f81.css">
<script src="/assets/js/runtime~main.8280aca9.js" defer="defer"></script>
<script src="/assets/js/main.c3d6c511.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Image Builder</b></a><a class="navbar__item navbar__link" href="/docs/hosted/architecture/">Hosted</a><a class="navbar__item navbar__link" href="/docs/on-premises/overview/">On Premises</a><a class="navbar__item navbar__link" href="/docs/bootc/">Bootc</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/user-guide/introduction/">User Guide</a><a class="navbar__item navbar__link" href="/docs/developer-guide/index/">Developer Guide</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/introduction/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/blueprint-reference/">Blueprint Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/repository-customizations/">Third-party Repositories</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/oscap-remediation/">OpenSCAP Remediation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/user-guide/uploading-cloud-images/">Uploading cloud images</a><button aria-label="Expand sidebar category &#x27;Uploading cloud images&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/uploading-to-registry/">Uploading a container image</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/uploading-to-pulp-stree/">Uploading an ostree commit to Pulp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/user-guide/partitioning/">Partitioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/user-guide/firstboot/">Firstboot script</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/user-guide/image-descriptions/">Image Descriptions</a><button aria-label="Expand sidebar category &#x27;Image Descriptions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Partitioning</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Partitioning</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="general-principles">General principles<a href="#general-principles" class="hash-link" aria-label="Direct link to General principles" title="Direct link to General principles">​</a></h2>
<ol>
<li>All sizes, whether for specific filesystems, partitions, logical volumes, or the image itself, are treated as minimum requirements. This means the full disk image size is always larger than the size of the sum of the partitions, due to requirements for headers and metadata.</li>
<li>The partition that contains the root filesystem, whether this is a plain formatted partition, an LVM Volume Group, or a Btrfs partition, is always last in the partition table layout when it is automatically added. For <a href="#using-disk-customizations">Disk customizations</a> the user-defined order is respected.</li>
<li>In the case of raw partitioning (no LVM and no Btrfs), the partition containing the root filesystem is grown to fill any left over space on the partition table. Logical Volumes are not grown to fill the space in the Volume Group since they are trivial to grow on a live system.</li>
</ol>
<p>In addition to the above, certain directories have hard-coded minimum sizes which cannot be overridden. These are 1 GiB for <code>/</code> and 2 GiB for <code>/usr</code>. This means that, if <code>/usr</code> is not on a separate partition, the root filesystem will always be at least 3 GiB.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-filesystem-customizations">Using Filesystem customizations<a href="#using-filesystem-customizations" class="hash-link" aria-label="Direct link to Using Filesystem customizations" title="Direct link to Using Filesystem customizations">​</a></h2>
<p>When using the <a href="/docs/user-guide/blueprint-reference/#filesystems">Filesystem customizations</a>, the final partition table of an image built with image builder is determined by a combination of the following:</p>
<ol>
<li>The base partition table for a given image type.</li>
<li>The relevant blueprint customizations:<!-- -->
<ol>
<li><a href="/docs/user-guide/blueprint-reference/#partitioning-mode">Partitioning mode</a>.</li>
<li><a href="/docs/user-guide/blueprint-reference/#filesystems">Filesystem customizations</a>.</li>
</ol>
</li>
<li>The image size parameter of the build request.<!-- -->
<ol>
<li>On the command line, this is the <code>--size</code> argument of the <code>composer-cli compose start</code> command.</li>
<li>In the service, this is the <code>size</code> parameter of an <code>image_request</code>.</li>
</ol>
</li>
</ol>
<p>This page describes how these elements affect the final layout of the partition table.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-partition-tables">Modifying partition tables<a href="#modifying-partition-tables" class="hash-link" aria-label="Direct link to Modifying partition tables" title="Direct link to Modifying partition tables">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="partitioning-modes">Partitioning modes<a href="#partitioning-modes" class="hash-link" aria-label="Direct link to Partitioning modes" title="Direct link to Partitioning modes">​</a></h4>
<p>The partitioning mode controls how the partition table is modified from the image type&#x27;s default layout.</p>
<ul>
<li><code>raw</code> will not convert any partition to LVM or Btrfs.</li>
<li><code>lvm</code> will always convert the partition that contains the root mountpoint <code>/</code> to an LVM Volume Group and create a root Logical Volume. Any extra mountpoints, except <code>/boot</code>, will be added to the Volume Group as new Logical Volumes.</li>
<li><code>btrfs</code> will convert the partition that contains the root mountpoint <code>/</code> to a Btrfs volume and create a root subvolume. Any extra mountpoints, except <code>/boot</code>, will be added to the Btrfs volume as new Btrfs subvolumes.</li>
<li><code>auto-lvm</code> is the default mode and will convert a raw partition table to an LVM-based one if and only if new mountpoints are defined in the <a href="/docs/user-guide/blueprint-reference/#filesystems">filesystems customization</a>. See also the <a href="#mountpoints">Mountpoints</a> section below.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mountpoints">Mountpoints<a href="#mountpoints" class="hash-link" aria-label="Direct link to Mountpoints" title="Direct link to Mountpoints">​</a></h4>
<p>New filesystems and minimum partition sizes are defined using the <a href="/docs/user-guide/blueprint-reference/#filesystems">filesystems customization</a> in the blueprint. By default, if new mountpoints are created, a partition table is automatically converted to LVM (see <a href="#partitioning-modes">Partitioning modes</a> above).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="image-size">Image size<a href="#image-size" class="hash-link" aria-label="Direct link to Image size" title="Direct link to Image size">​</a></h4>
<p>The minimum size of the partition table, which in turn will be the size of the disk image. The final size of the image will either be the value of the <code>size</code> parameter or the sum of all partitions and their associated metadata, whichever is larger.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-images-with-exact-sizes">Creating images with exact sizes<a href="#creating-images-with-exact-sizes" class="hash-link" aria-label="Direct link to Creating images with exact sizes" title="Direct link to Creating images with exact sizes">​</a></h3>
<p>If a disk image of a very specific size is required, the exact <a href="#image-size">Image size</a> should be specified in the build request and any <a href="#mountpoints">Mountpoints</a> defined as customizations should specify sizes that are smaller than the total size in sum. The partition table, partitions, and other entities often require extra space for metadata and headers, so the space required to fit all the mountpoints is always larger than the sum of the size of the partitions. The exact size of the extra space that is required varies based on too many factors to cover here exhaustively.</p>
<p>The best strategy for creating a disk image of a very specific size is the following:</p>
<ol>
<li>Set the <a href="#image-size">Image size</a> parameter to the desired size.</li>
<li>Add any extra desired mountpoints with their required minimum sizes, making sure that the sum of the sizes is smaller than the image size by at least 3.01 GiB if there is no <code>/usr</code> mountpoint, or at least 1.01 GiB if there is.<!-- -->
<ul>
<li>The extra 0.01 MiB is more than enough for the headers and metadata for which extra space might be reserved.</li>
</ul>
</li>
<li>Do not specify a size for the <code>/</code> mountpoint.</li>
</ol>
<p>The combination above will create a disk with a partition table of the desired size with each partition sized to fit the desired mountpoints. The root partition (or root LVM Logical Volume) will be at least 3 GiB (or 1 GiB if <code>/usr</code> is specified) (see note on directory sizes in <a href="#general-principles">General principles</a> above).</p>
<ul>
<li>If the partition table does not have any LVM Volume Groups or Btrfs volumes, the root partition will be grown to fill the remaining space.</li>
<li>If the partition table contains an LVM Volume Group, the VG will have unallocated extents that can be used to grow any of the Logical Volumes.</li>
<li>If the partition table contains a Btrfs volume, the partition for that volume will be grown to fill the remaining space.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-disk-customizations">Using Disk customizations<a href="#using-disk-customizations" class="hash-link" aria-label="Direct link to Using Disk customizations" title="Direct link to Using Disk customizations">​</a></h2>
<p>When using the <a href="/docs/user-guide/blueprint-reference/#disk">Disk customizations</a>, the partition table can be described almost entirely using the blueprint. The customizations have the following structure:</p>
<ul>
<li><code>partitions</code>: At the top level is a list of partitions.<!-- -->
<ul>
<li><code>type</code>: Each partition has a <code>type</code>, which should be one of <code>plain</code>, <code>lvm</code>, or <code>btrfs</code>. If the <code>type</code> is not set, it defaults to <code>plain</code>. The rest of the required and optional properties of the partition depend on the <code>type</code>.<!-- -->
<ul>
<li><code>plain</code>: A plain partition is a partition with a filesystem. It supports the following properties:<!-- -->
<ul>
<li><code>fs_type</code>: The filesystem type, which should be one of <code>xfs</code>, <code>ext4</code>, <code>vfat</code>, or <code>swap</code>. Setting it to <code>swap</code> will create a swap partition. The <code>mountpoint</code> for a swap partition must be empty.</li>
<li><code>minsize</code>: The minimum size of the partition, as an integer (in bytes) or a string with a data unit (e.g. <code>3 GiB</code>). The final size of the partition in the image might be larger for specific mountpoints (see the <a href="#general-principles">General principles</a> above).</li>
<li><code>mountpoint</code>: The mountpoint for the filesystem. For <code>swap</code> partitions, this must be empty.</li>
<li><code>label</code>: The label for the filesystem (optional).</li>
</ul>
</li>
<li><code>lvm</code>: An lvm partition is a partition with an LVM volume group. Only single-PV volume groups are supported. It supports the following properties:<!-- -->
<ul>
<li><code>name</code>: The name of the volume group (optional; if unset, a name will be generated automatically).</li>
<li><code>minsize</code>: The minimum size of the volume group, as an integer (in bytes) or a string with a data unit (e.g. <code>3 GiB</code>). The final size of the partition and volume group in the image might be larger if the value is smaller than the sum of logical volumes it contains.</li>
<li><code>logical_volumes</code>: One or more logical volumes for the volume group. Each volume group supports the following properties:<!-- -->
<ul>
<li><code>name</code>: The name of the logical volume (optional; if unset, a name will be generated automatically based on the mountpoint).</li>
<li><code>minsize</code>: The minimum size of the logical volume, as an integer (in bytes) or a string with a data unit (e.g. <code>3 GiB</code>). The final size of the logical volume in the image might be larger for specific mountpoints (see the <a href="#general-principles">General principles</a> above).</li>
<li><code>label</code>: The label for the filesystem (optional).</li>
<li><code>fs_type</code>: The filesystem type, which should be one of <code>xfs</code>, <code>ext4</code>, <code>vfat</code>, or <code>swap</code>. Setting it to <code>swap</code> will create a swap logical volume. The <code>mountpoint</code> for a swap logical volume must be empty.</li>
<li><code>mountpoint</code>: The mountpoint for the logical volume&#x27;s filesystem. For <code>swap</code> logical volumes, this must be empty.</li>
</ul>
</li>
</ul>
</li>
<li><code>btrfs</code>: A partition with a btrfs volume. It supports the following properties:<!-- -->
<ul>
<li><code>minsize</code>: The minimum size of the partition, as an integer (in bytes) or a string with a data unit (e.g. <code>3 GiB</code>). The final size of the partition in the image might be larger to accommodate specific mountpoints (see the <a href="#general-principles">General principles</a> above).</li>
<li><code>subvolumes</code>: One or more subvolumes for the btrfs volume. Each subvolume supports the following properties:<!-- -->
<ul>
<li><code>name</code>: The name of the subvolume, which also defines its location on the parent volume.</li>
<li><code>mountpoint</code>: The mountpoint for the subvolume.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="order">Order<a href="#order" class="hash-link" aria-label="Direct link to Order" title="Direct link to Order">​</a></h3>
<p>The order of each element in a list is respected when creating the partition table. Partitions are created in the order they are defined, regardless of their type.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="incomplete-partition-tables">Incomplete partition tables<a href="#incomplete-partition-tables" class="hash-link" aria-label="Direct link to Incomplete partition tables" title="Direct link to Incomplete partition tables">​</a></h3>
<p>Incomplete partitioning descriptions are valid. Partitions, LVM logical volumes, and btrfs subvolumes are added automatically to create a valid partition table. The following rules are applied:</p>
<ul>
<li>A root filesystem is added if one is not defined. This is identified by the mountpoint <code>/</code>. If an LVM volume group or btrfs volume is defined, the root filesystem is created as a logical volume or btrfs volume respectively, otherwise it will be created as a plain partition with a filesystem. The type of the filesystem, for plain and LVM, depends on the distribution (<code>xfs</code> for RHEL and CentOS, <code>ext4</code> for Fedora). See the <a href="#general-principles">General principles</a> section for information about the sizing and order of the root partition.</li>
<li>A boot partition is created if needed and if one is not defined. This is identified by the mountpoint <code>/boot</code>. A boot partition is needed when the root partition (mountpoint <code>/</code>) is on an LVM logical volume or a btrfs volume. The type of the filesystem, for plain and LVM, depends on the distribution (<code>xfs</code> for RHEL and CentOS, <code>ext4</code> for Fedora). It is created as the first partition after the ESP (see next item).</li>
<li>An EFI system partition (ESP) is created if needed. This is identified by the mountpoint <code>/boot/efi</code>. An ESP is needed when the image is configured to boot with UEFI. This is defined by the image definition and depends on the image type, the distribution, and the architecture. The type of the filesystem is always <code>vfat</code>. By default, the ESP is 200 MiB and is the first partition after the BIOS boot (see next item).</li>
<li>A 1 MiB unformatted BIOS boot partition is created at the start of the partition table if the image is configured to boot with BIOS. This is defined by the image definition and depends on the image type, the distribution, and the architecture.</li>
<li>Both a BIOS boot partition and an ESP are created for images that are configured for hybrid boot.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="combining-partition-types">Combining partition types<a href="#combining-partition-types" class="hash-link" aria-label="Direct link to Combining partition types" title="Direct link to Combining partition types">​</a></h3>
<p>Multiple partitions can be defined. The following combination of partition types are valid:</p>
<ul>
<li><code>plain</code> and <code>lvm</code>: Plain partitions can be created alongside an LVM volume group. However, only one LVM volume group can be defined.</li>
<li><code>plain</code> and <code>btrfs</code>: Plain partitions can be created alongside btrfs volumes. However, only one btrfs volume can be defined.</li>
<li><code>btrfs</code> and <code>lvm</code> cannot be combined on the same partition table.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h3>
<ol>
<li>The following blueprint defines two partitions. The first is a 50 GiB partition with an ext4 filesystem that will be mounted at <code>/data</code>. The second is an LVM volume group with three logical volumes, one for root <code>/</code>, one for home directories <code>/home</code>, and a swap space in that order. The LVM volume group will have 15 GiB of unallocated space.</li>
</ol>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;plain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">label</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">fs_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ext4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;50 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lvm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mainvg&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;20 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions.logical_volumes</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rootlv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">label</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">fs_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ext4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions.logical_volumes</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;homelv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/home&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">label</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;home&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">fs_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ext4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions.logical_volumes</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;swaplv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">fs_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;swap&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1 GiB&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>The following blueprint defines two partitions. The first is a 20 GiB btrfs volume with two subvolumes, one for root <code>/</code> and one for data <code>/data</code>. The second is a 4 GiB swap partition.</li>
</ol>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;btrfs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;20 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions.subvolumes</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions.subvolumes</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.disk.partitions</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;plain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">fs_type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;swap&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4 GiB&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/osbuild/osbuild.github.io/tree/main/docs/user-guide/07-partitioning.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user-guide/uploading-to-pulp-stree/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Uploading an ostree commit to Pulp</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user-guide/firstboot/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Firstboot script</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#general-principles" class="table-of-contents__link toc-highlight">General principles</a></li><li><a href="#using-filesystem-customizations" class="table-of-contents__link toc-highlight">Using Filesystem customizations</a><ul><li><a href="#modifying-partition-tables" class="table-of-contents__link toc-highlight">Modifying partition tables</a></li><li><a href="#creating-images-with-exact-sizes" class="table-of-contents__link toc-highlight">Creating images with exact sizes</a></li></ul></li><li><a href="#using-disk-customizations" class="table-of-contents__link toc-highlight">Using Disk customizations</a><ul><li><a href="#order" class="table-of-contents__link toc-highlight">Order</a></li><li><a href="#incomplete-partition-tables" class="table-of-contents__link toc-highlight">Incomplete partition tables</a></li><li><a href="#combining-partition-types" class="table-of-contents__link toc-highlight">Combining partition types</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/orgs/osbuild/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://matrix.to/#/#image-builder:fedoraproject.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/osbuild/osbuild.github.io/commits/74259a02a8a03541f0ed223220317e58c8bbefc3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Red Hat, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>