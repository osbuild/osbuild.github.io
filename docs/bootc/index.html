<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-bootc/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">bootc-image-builder | Image Builder</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://osbuild.org/docs/bootc/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="bootc-image-builder | Image Builder"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://osbuild.org/docs/bootc/"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/bootc/" hreflang="en"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/bootc/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2d858f81.css">
<script src="/assets/js/runtime~main.ee5dd277.js" defer="defer"></script>
<script src="/assets/js/main.ecda619d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Image Builder</b></a><a class="navbar__item navbar__link" href="/docs/hosted/architecture/">Hosted</a><a class="navbar__item navbar__link" href="/docs/on-premises/overview/">On Premises</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/bootc/">Bootc</a><a class="navbar__item navbar__link" href="/docs/user-guide/introduction/">User Guide</a><a class="navbar__item navbar__link" href="/docs/developer-guide/index/">Developer Guide</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/bootc/">bootc-image-builder</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">bootc-image-builder</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>bootc-image-builder</h1></header>
<p>A container to create disk images from <a href="https://github.com/containers/bootc" target="_blank" rel="noopener noreferrer">bootc</a> container inputs,
especially oriented towards <a href="https://docs.fedoraproject.org/en-US/bootc/" target="_blank" rel="noopener noreferrer">Fedora/CentOS bootc</a> or
derivatives.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-installation">🔨 Installation<a href="#-installation" class="hash-link" aria-label="Direct link to 🔨 Installation" title="Direct link to 🔨 Installation">​</a></h2>
<p>Have <a href="https://podman.io/" target="_blank" rel="noopener noreferrer">podman</a> installed on your system. Either through your systems package manager if you&#x27;re on
Linux or through <a href="https://podman.io/" target="_blank" rel="noopener noreferrer">Podman Desktop</a> if you are on macOS or Windows. If you want to run the resulting
virtual machine(s) or installer media you can use <a href="https://www.qemu.org/" target="_blank" rel="noopener noreferrer">qemu</a>.</p>
<p>A very nice GUI extension for Podman Desktop is also
<a href="https://github.com/containers/podman-desktop-extension-bootc" target="_blank" rel="noopener noreferrer">available</a>.
The command line examples below can be all handled by
Podman Desktop.</p>
<p>On macOS, the podman machine must be running in rootful mode:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ podman machine stop   # if already running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for VM to exit...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Machine &quot;podman-machine-default&quot; stopped successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ podman machine set --rootful</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ podman machine start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-prerequisites">✍ Prerequisites<a href="#-prerequisites" class="hash-link" aria-label="Direct link to ✍ Prerequisites" title="Direct link to ✍ Prerequisites">​</a></h2>
<p>If you are on a system with SELinux enforced: The package <code>osbuild-selinux</code> or equivalent osbuild SELinux policies must be installed in the system running
<code>bootc-image-builder</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-examples">🚀 Examples<a href="#-examples" class="hash-link" aria-label="Direct link to 🚀 Examples" title="Direct link to 🚀 Examples">​</a></h2>
<p>The following example builds a <code>centos-bootc:stream9</code> bootable container into a QCOW2 image for the architecture you&#x27;re running
the command on.  However, be sure to see the <a href="https://docs.fedoraproject.org/en-US/bootc/" target="_blank" rel="noopener noreferrer">upstream documentation</a>
for more general information!  Note that outside of initial experimentation, it&#x27;s recommended to build a <em>derived</em> container image
(or reuse a derived image built via someone else) and then use this project to make a disk image from your custom image.</p>
<p>The generic base images do not include a default user. This example injects a <a href="#-build-config">user configuration file</a>
by adding a volume-mount for the local file to the bootc-image-builder container.</p>
<p>The following command will create a QCOW2 disk image. First, create <code>./config.toml</code> as described above to configure user access.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Ensure the image is fetched</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo podman pull quay.io/centos-bootc/centos-bootc:stream9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo podman run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -it \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --privileged \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --pull=newer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --security-opt label=type:unconfined_t \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v ./config.toml:/config.toml:ro \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v ./output:/output \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /var/lib/containers/storage:/var/lib/containers/storage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quay.io/centos-bootc/bootc-image-builder:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type qcow2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --use-librepo=True \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quay.io/centos-bootc/centos-bootc:stream9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that some images (like fedora) do not have a default root
filesystem type. In this case adds the switch <code>--rootfs &lt;type&gt;</code>,
e.g. <code>--rootfs btrfs</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-resulting-qcow2-file-on-linux-x86_64">Running the resulting QCOW2 file on Linux (x86_64)<a href="#running-the-resulting-qcow2-file-on-linux-x86_64" class="hash-link" aria-label="Direct link to Running the resulting QCOW2 file on Linux (x86_64)" title="Direct link to Running the resulting QCOW2 file on Linux (x86_64)">​</a></h3>
<p>A virtual machine can be launched using <code>qemu-system-x86_64</code> or with <code>virt-install</code> as shown below;
however there is more information about virtualization and other
choices in the <a href="https://docs.fedoraproject.org/en-US/bootc/" target="_blank" rel="noopener noreferrer">Fedora/CentOS bootc documentation</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="qemu-system-x86_64">qemu-system-x86_64<a href="#qemu-system-x86_64" class="hash-link" aria-label="Direct link to qemu-system-x86_64" title="Direct link to qemu-system-x86_64">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">qemu-system-x86_64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -M accel=kvm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -cpu host \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -smp 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -m 4096 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -bios /usr/share/OVMF/OVMF_CODE.fd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -serial stdio \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -snapshot output/qcow2/disk.qcow2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="virt-install">virt-install<a href="#virt-install" class="hash-link" aria-label="Direct link to virt-install" title="Direct link to virt-install">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo virt-install \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --name fedora-bootc \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cpu host \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --vcpus 4 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --memory 4096 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --import --disk ./output/qcow2/disk.qcow2,format=qcow2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --os-variant fedora-eln</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-resulting-qcow2-file-on-macos-aarch64">Running the resulting QCOW2 file on macOS (aarch64)<a href="#running-the-resulting-qcow2-file-on-macos-aarch64" class="hash-link" aria-label="Direct link to Running the resulting QCOW2 file on macOS (aarch64)" title="Direct link to Running the resulting QCOW2 file on macOS (aarch64)">​</a></h3>
<p>This assumes qemu was installed through <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">homebrew</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">qemu-system-aarch64 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -M accel=hvf \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -cpu host \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -smp 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -m 4096 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -bios /opt/homebrew/Cellar/qemu/8.1.3_2/share/qemu/edk2-aarch64-code.fd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -serial stdio \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -machine virt \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -snapshot output/qcow2/disk.qcow2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-arguments">📝 Arguments<a href="#-arguments" class="hash-link" aria-label="Direct link to 📝 Arguments" title="Direct link to 📝 Arguments">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Usage:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sudo podman run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -it \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --privileged \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --pull=newer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --security-opt label=type:unconfined_t \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v ./output:/output \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /var/lib/containers/storage:/var/lib/containers/storage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quay.io/centos-bootc/bootc-image-builder:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;imgref&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --chown string          chown the ouput directory to match the specified UID:GID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --output string         artifact output directory (default &quot;.&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --progress string       type of progress bar to use (e.g. verbose,term) (default &quot;auto&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --rootfs string         Root filesystem type. If not given, the default configured in the source container image is used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --target-arch string    build for the given target architecture (experimental)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --type stringArray      image types to build [ami, anaconda-iso, gce, iso, qcow2, raw, vhd, vmdk] (default [qcow2])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --version               version for bootc-image-builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Global Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --log-level string   logging level (debug, info, error); default error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v, --verbose            Switch to verbose mode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-description-of-optional-flags">Detailed description of optional flags<a href="#detailed-description-of-optional-flags" class="hash-link" aria-label="Direct link to Detailed description of optional flags" title="Direct link to Detailed description of optional flags">​</a></h3>
<table><thead><tr><th>Argument</th><th>Description</th><th style="text-align:center">Default Value</th></tr></thead><tbody><tr><td>--chown</td><td>chown the output directory to match the specified UID<!-- -->:GID</td><td style="text-align:center">❌</td></tr><tr><td>--output</td><td>output the artifact into the given output directory</td><td style="text-align:center"><code>.</code></td></tr><tr><td>--progress</td><td>Show progress in the given format, supported: verbose,term,debug. If empty it is auto-detected</td><td style="text-align:center"><code>auto</code></td></tr><tr><td><strong>--rootfs</strong></td><td>Root filesystem type. Overrides the default from the source container. Supported values: ext4, xfs, btrfs</td><td style="text-align:center">❌</td></tr><tr><td><strong>--type</strong></td><td><a href="#-image-types">Image type</a> to build (can be passed multiple times)</td><td style="text-align:center"><code>qcow2</code></td></tr><tr><td>--target-arch</td><td><a href="#-target-architecture">Target arch</a> to build</td><td style="text-align:center">❌</td></tr><tr><td>--log-level</td><td>Change log level (debug, info, error)</td><td style="text-align:center"><code>error</code></td></tr><tr><td>-v,--verbose</td><td>Switch output/progress to verbose mode (implies --log-level=info)</td><td style="text-align:center"><code>false</code></td></tr><tr><td>--use-librepo</td><td>Download rpms using librepo (faster and more robust)</td><td style="text-align:center"><code>false</code></td></tr></tbody></table>
<p>The <code>--type</code> parameter can be given multiple times and multiple
outputs will be produced. Note that comma or space separating the
<code>image-types</code>will not work, but this example will: <code>--type qcow2 --type ami</code>.</p>
<p><em>💡 Tip: Flags in <strong>bold</strong> are the most important ones.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-image-types">💾 Image types<a href="#-image-types" class="hash-link" aria-label="Direct link to 💾 Image types" title="Direct link to 💾 Image types">​</a></h2>
<p>The following image types are currently available via the <code>--type</code> argument:</p>
<table><thead><tr><th>Image type</th><th>Target environment</th></tr></thead><tbody><tr><td><code>ami</code></td><td><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html" target="_blank" rel="noopener noreferrer">Amazon Machine Image</a></td></tr><tr><td><code>qcow2</code> <strong>(default)</strong></td><td><a href="https://www.qemu.org/" target="_blank" rel="noopener noreferrer">QEMU</a></td></tr><tr><td><code>vmdk</code></td><td><a href="https://en.wikipedia.org/wiki/VMDK" target="_blank" rel="noopener noreferrer">VMDK</a> usable in vSphere, among others</td></tr><tr><td><code>anaconda-iso</code></td><td>An unattended Anaconda installer that installs to the first disk found.</td></tr><tr><td><code>raw</code></td><td>Unformatted <a href="https://en.wikipedia.org/wiki/Rawdisk" target="_blank" rel="noopener noreferrer">raw disk</a>.</td></tr><tr><td><code>vhd</code></td><td><a href="https://en.wikipedia.org/wiki/VHD_(file_format)" target="_blank" rel="noopener noreferrer">vhd</a> usable in Virtual PC, among others</td></tr><tr><td><code>gce</code></td><td><a href="https://cloud.google.com/compute/docs/images#custom_images" target="_blank" rel="noopener noreferrer">GCE</a></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-target-architecture">💾 Target architecture<a href="#-target-architecture" class="hash-link" aria-label="Direct link to 💾 Target architecture" title="Direct link to 💾 Target architecture">​</a></h2>
<p>Specify the target architecture of the system on which the disk image will be installed on. By default,
<code>bootc-image-builder</code> will build for the native host architecture. The target architecture
must match an available architecture of the <code>bootc-image-builder</code> image you are using to build the disk image.
Navigate to the <a href="https://quay.io/repository/centos-bootc/bootc-image-builder?tab=tags" target="_blank" rel="noopener noreferrer">centos-image-builder repository tags page</a>
and hover over the Tux icons to see the supported target architectures.
The architecture of the bootc OCI image and the bootc-image-builder image must match. For example, when building
a non-native architecture bootc OCI image, say, building for x86_64 from an arm-based Mac, it is possible to run
<code>podman build</code> with the <code>--platform linux/amd64</code> flag. In this case, to then build a disk image from the same arm-based Mac,
you should provide <code>--target-arch amd64</code> when running the <code>bootc-image-builder</code> command.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="progress-types">Progress types<a href="#progress-types" class="hash-link" aria-label="Direct link to Progress types" title="Direct link to Progress types">​</a></h2>
<p>The following progress types are supported:</p>
<ul>
<li>verbose: No spinners or progress bar, just information and full osbuild output</li>
<li>term: Terminal based output, spinner, progressbar and most details of osbuild are hidden</li>
<li>debug: Details how the progress is called, mostly useful for bugreports</li>
</ul>
<p>Note that when no value is given the progress is auto-detected baed on the environment. When <code>stdin</code> is a terminal the &quot;term&quot; progress is used, otherwise &quot;verbose&quot;. The output of <code>verbose</code> is exactaly the same as it was before progress reporting was implemented.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-cloud-uploaders">☁️ Cloud uploaders<a href="#️-cloud-uploaders" class="hash-link" aria-label="Direct link to ☁️ Cloud uploaders" title="Direct link to ☁️ Cloud uploaders">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="amazon-machine-images-amis">Amazon Machine Images (AMIs)<a href="#amazon-machine-images-amis" class="hash-link" aria-label="Direct link to Amazon Machine Images (AMIs)" title="Direct link to Amazon Machine Images (AMIs)">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h4>
<p>In order to successfully import an AMI into your AWS account, you need to have the <a href="https://docs.aws.amazon.com/vm-import/latest/userguide/required-permissions.html" target="_blank" rel="noopener noreferrer">vmimport service role</a> configured on your account with the following additional permissions:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3:ListAllMyBuckets&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3:GetBucketAcl&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;s3:DeleteObject&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Resource&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;arn:aws:s3:::amzn-s3-demo-import-bucket&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;arn:aws:s3:::amzn-s3-demo-import-bucket/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;arn:aws:s3:::amzn-s3-demo-export-bucket&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;arn:aws:s3:::amzn-s3-demo-export-bucket/*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>amzn-s3-demo-import-bucket</code> in the ARN with the bucket name.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="flags">Flags<a href="#flags" class="hash-link" aria-label="Direct link to Flags" title="Direct link to Flags">​</a></h4>
<p>AMIs can be automatically uploaded to AWS by specifying the following flags:</p>
<table><thead><tr><th>Argument</th><th>Description</th></tr></thead><tbody><tr><td>--aws-ami-name</td><td>Name for the AMI in AWS</td></tr><tr><td>--aws-bucket</td><td>Target S3 bucket name for intermediate storage when creating AMI</td></tr><tr><td>--aws-region</td><td>Target region for AWS uploads</td></tr></tbody></table>
<p><em>Notes:</em></p>
<ul>
<li><em>These flags must all be specified together. If none are specified, the AMI is exported to the output directory.</em></li>
<li><em>The bucket must already exist in the selected region, bootc-image-builder will not create it if it is missing.</em></li>
<li><em>The output volume is not needed in this case. The image is uploaded to AWS and not exported.</em></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aws-credentials-file">AWS credentials file<a href="#aws-credentials-file" class="hash-link" aria-label="Direct link to AWS credentials file" title="Direct link to AWS credentials file">​</a></h4>
<p>If you already have a credentials file (usually in <code>$HOME/.aws/credentials</code>) you need to forward the
directory to the container</p>
<p>For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo podman run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -it \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pull=newer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-opt label=type:unconfined_t \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v $HOME/.aws:/root/.aws:ro \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /var/lib/containers/storage:/var/lib/containers/storage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --env AWS_PROFILE=default \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quay.io/centos-bootc/bootc-image-builder:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type ami \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-ami-name centos-bootc-ami \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-bucket fedora-bootc-bucket \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-region us-east-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quay.io/centos-bootc/centos-bootc:stream9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notes:</p>
<ul>
<li><em>you can also inject <strong>ALL</strong> your AWS configuration parameters with <code>--env AWS_*</code></em></li>
</ul>
<p>see the <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html" target="_blank" rel="noopener noreferrer">AWS CLI documentation</a> for more information about other environment variables</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aws-credentials-via-environment">AWS credentials via environment<a href="#aws-credentials-via-environment" class="hash-link" aria-label="Direct link to AWS credentials via environment" title="Direct link to AWS credentials via environment">​</a></h4>
<p>AWS credentials can be specified through two environment variables:</p>
<table><thead><tr><th>Variable name</th><th>Description</th></tr></thead><tbody><tr><td>AWS_ACCESS_KEY_ID</td><td>AWS access key associated with an IAM account.</td></tr><tr><td>AWS_SECRET_ACCESS_KEY</td><td>Specifies the secret key associated with the access key. This is essentially the &quot;password&quot; for the access key.</td></tr></tbody></table>
<p>Those <strong>should not</strong> be specified with <code>--env</code> as plain value, but you can silently hand them over with <code>--env AWS_*</code> or
save these variables in a file and pass them using the <code>--env-file</code> flag for <code>podman run</code>.</p>
<p>For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat aws.secrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo podman run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -it \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pull=newer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-opt label=type:unconfined_t \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v /var/lib/containers/storage:/var/lib/containers/storage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --env-file=aws.secrets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quay.io/centos-bootc/bootc-image-builder:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type ami \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-ami-name centos-bootc-ami \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-bucket centos-bootc-bucket \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --aws-region us-east-1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quay.io/centos-bootc/centos-bootc:stream9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-volumes">💽 Volumes<a href="#-volumes" class="hash-link" aria-label="Direct link to 💽 Volumes" title="Direct link to 💽 Volumes">​</a></h2>
<p>The following volumes can be mounted inside the container:</p>
<table><thead><tr><th>Volume</th><th>Purpose</th><th style="text-align:center">Required</th></tr></thead><tbody><tr><td><code>/output</code></td><td>Used for storing the resulting artifacts</td><td style="text-align:center">✅</td></tr><tr><td><code>/store</code></td><td>Used for the <a href="https://www.osbuild.org/" target="_blank" rel="noopener noreferrer">osbuild store</a></td><td style="text-align:center">No</td></tr><tr><td><code>/rpmmd</code></td><td>Used for the DNF cache</td><td style="text-align:center">No</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-build-config">📝 Build config<a href="#-build-config" class="hash-link" aria-label="Direct link to 📝 Build config" title="Direct link to 📝 Build config">​</a></h2>
<p>A build config is a Toml (or JSON) file with customizations for the resulting image. The config file is mapped into the container directory to <code>/config.toml</code>. The customizations are specified under a <code>customizations</code> object.</p>
<p>As an example, let&#x27;s show how you can add a user to the image:</p>
<p>Firstly create a file <code>./config.toml</code> and put the following content into it:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;alice&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">password</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bob&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">key</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ssh-rsa AAA ... user@email.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">groups</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;wheel&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, run <code>bootc-image-builder</code> with the following arguments:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo podman run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -it \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --privileged \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --pull=newer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --security-opt label=type:unconfined_t \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v ./config.toml:/config.toml:ro \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v ./output:/output \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -v /var/lib/containers/storage:/var/lib/containers/storage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quay.io/centos-bootc/bootc-image-builder:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --type qcow2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    quay.io/centos-bootc/centos-bootc:stream9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The configuration can also be passed in via stdin when <code>--config -</code>
is used. Only JSON configuration is supported in this mode.</p>
<p>Additionally, images can embed a build config file, either as
<code>config.json</code> or <code>config.toml</code> in the <code>/usr/lib/bootc-image-builder</code>
directory. If this exist, and contains filesystem or disk
customizations, then these are used by default if no such
customization are specified in the regular build config.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="users-user-array">Users (<code>user</code>, array)<a href="#users-user-array" class="hash-link" aria-label="Direct link to users-user-array" title="Direct link to users-user-array">​</a></h3>
<p>Possible fields:</p>
<table><thead><tr><th>Field</th><th>Use</th><th style="text-align:center">Required</th></tr></thead><tbody><tr><td><code>name</code></td><td>Name of the user</td><td style="text-align:center">✅</td></tr><tr><td><code>password</code></td><td>Unencrypted password</td><td style="text-align:center">No</td></tr><tr><td><code>key</code></td><td>Public SSH key contents</td><td style="text-align:center">No</td></tr><tr><td><code>groups</code></td><td>An array of secondary to put the user into</td><td style="text-align:center">No</td></tr></tbody></table>
<p>Example:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customizations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;user&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;alice&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;password&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bob&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ssh-rsa AAA ... user@email.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;groups&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;wheel&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;admins&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-arguments-kernel-mapping">Kernel Arguments (<code>kernel</code>, mapping)<a href="#kernel-arguments-kernel-mapping" class="hash-link" aria-label="Direct link to kernel-arguments-kernel-mapping" title="Direct link to kernel-arguments-kernel-mapping">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customizations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kernel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;append&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mitigations=auto,nosmt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="filesystems-filesystem-array">Filesystems (<code>filesystem</code>, array)<a href="#filesystems-filesystem-array" class="hash-link" aria-label="Direct link to filesystems-filesystem-array" title="Direct link to filesystems-filesystem-array">​</a></h3>
<p>The filesystem section of the customizations can be used to set the minimum size of the base partitions (<code>/</code> and <code>/boot</code>) as well as to create extra partitions with mountpoints under <code>/var</code>.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.filesystem</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.filesystem</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">mountpoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/data&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">minsize</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;20 GiB&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customizations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;filesystem&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mountpoint&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;minsize&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;mountpoint&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;minsize&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;20 GiB&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="interaction-with-rootfs">Interaction with <code>rootfs</code><a href="#interaction-with-rootfs" class="hash-link" aria-label="Direct link to interaction-with-rootfs" title="Direct link to interaction-with-rootfs">​</a></h4>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="filesystem-types">Filesystem types<a href="#filesystem-types" class="hash-link" aria-label="Direct link to Filesystem types" title="Direct link to Filesystem types">​</a></h4>
<p>The <code>--rootfs</code> option also sets the filesystem types for all additional mountpoints, where appropriate. See the see <a href="#detailed-description-of-optional-flags">Detailed description of optional flags</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="allowed-mountpoints-and-sizes">Allowed mountpoints and sizes<a href="#allowed-mountpoints-and-sizes" class="hash-link" aria-label="Direct link to Allowed mountpoints and sizes" title="Direct link to Allowed mountpoints and sizes">​</a></h4>
<p>The following restrictions and rules apply, unless the rootfs is <code>btrfs</code>:</p>
<ul>
<li><code>/</code> can be specified to set the desired (minimum) size of the root filesystem. The final size of the filesystem, mounted at <code>/sysroot</code> on a booted system, is the value specified in this configuration or 2x the size of the base container, whichever is largest.</li>
<li><code>/boot</code>can be specified to set the desired size of the boot partition.</li>
<li>Subdirectories of <code>/var</code> are supported, but symlinks in <code>/var</code> are not. For example, <code>/var/home</code> and <code>/var/run</code> are symlinks and cannot be filesystems on their own.</li>
<li><code>/var</code> itself cannot be a mountpoint.</li>
</ul>
<p>The <code>rootfs</code> option (or source container config, see <a href="#detailed-description-of-optional-flags">Detailed description of optional flags</a> section) defines the filesystem type for the root filesystem. Currently, creation of btrfs subvolumes at build time is not supported. Therefore, if the <code>rootfs</code> is <code>btrfs</code>, no custom mountpoints are supported under <code>/var</code>.  Only <code>/</code> and <code>/boot</code> can be configured.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="anaconda-iso-installer-options-installer-mapping">Anaconda ISO (installer) options (<code>installer</code>, mapping)<a href="#anaconda-iso-installer-options-installer-mapping" class="hash-link" aria-label="Direct link to anaconda-iso-installer-options-installer-mapping" title="Direct link to anaconda-iso-installer-options-installer-mapping">​</a></h3>
<p>Users can include kickstart file content that will be added to an ISO build to configure the installation process. When using custom kickstart scripts the customization needs to be done via the custom kickstart script. For example using a <code>[customizations.user]</code> block alongside a <code>[customizations.installer.kickstart]</code> block is not supported. See this issue [<a href="https://github.com/osbuild/bootc-image-builder/issues/528" target="_blank" rel="noopener noreferrer">https://github.com/osbuild/bootc-image-builder/issues/528</a>]<!-- --> for additional detail.</p>
<p>Since multi-line strings are difficult to write and read in json, it&#x27;s easier to use the toml format when adding kickstart contents:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.installer.kickstart</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">contents</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">text --non-interactive</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">zerombr</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">clearpart --all --initlabel --disklabel=gpt</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">autopart --noswap --type=lvm</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">network --bootproto=dhcp --device=link --activate --onboot=on</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The equivalent in json would be:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customizations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;installer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;kickstart&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;contents&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text --non-interactive\nzerombr\nclearpart --all --initlabel --disklabel=gpt\nautopart --noswap --type=lvm\nnetwork --bootproto=dhcp --device=link --activate --onboot=on&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that bootc-image-builder will automatically add the command that installs the container image (<code>ostreecontainer ...</code>), so this line or any line that conflicts with it should not be included. See the relevant <a href="https://pykickstart.readthedocs.io/en/latest/kickstart-docs.html#ostreecontainer" target="_blank" rel="noopener noreferrer">Kickstart documentation</a> for more information.
No other kickstart commands are added by bootc-image-builder in this case, so it is the responsibility of the user to provide all other commands (for example, for partitioning, network, language, etc).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="anaconda-iso-installer-modules">Anaconda ISO (installer) Modules<a href="#anaconda-iso-installer-modules" class="hash-link" aria-label="Direct link to Anaconda ISO (installer) Modules" title="Direct link to Anaconda ISO (installer) Modules">​</a></h4>
<p>The Anaconda installer can be configured by enabling or disabling its dbus modules.</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">customizations.installer.modules</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">enable</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;org.fedoraproject.Anaconda.Modules.Localization&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">disable</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;org.fedoraproject.Anaconda.Modules.Users&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;customizations&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;installer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;modules&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;enable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;org.fedoraproject.Anaconda.Modules.Localization&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;disable&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;org.fedoraproject.Anaconda.Modules.Users&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The following module names are known and supported:</p>
<ul>
<li><code>org.fedoraproject.Anaconda.Modules.Localization</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Network</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Payloads</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Runtime</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Security</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Services</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Storage</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Subscription</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Timezone</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Users</code></li>
</ul>
<p><em>Note: The values are not validated. Any name listed under <code>enable</code> will be added to the Anaconda configuration. This way, new or unknown modules can be enabled. However, it also means that mistyped or incorrect values may cause Anaconda to fail to start.</em></p>
<p>By default, the following modules are enabled for all Anaconda ISOs:</p>
<ul>
<li><code>org.fedoraproject.Anaconda.Modules.Network</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Payloads</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Security</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Services</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Storage</code></li>
<li><code>org.fedoraproject.Anaconda.Modules.Users</code></li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="enable-vs-disable-priority">Enable vs Disable priority<a href="#enable-vs-disable-priority" class="hash-link" aria-label="Direct link to Enable vs Disable priority" title="Direct link to Enable vs Disable priority">​</a></h5>
<p>The <code>disable</code> list is processed after the <code>enable</code> list and therefore takes priority. In other words, adding the same module in both <code>enable</code> and <code>disable</code> will result in the module being <strong>disabled</strong>.
Furthermore, adding a module that is enabled by default to <code>disable</code> will result in the module being <strong>disabled</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building">Building<a href="#building" class="hash-link" aria-label="Direct link to Building" title="Direct link to Building">​</a></h2>
<p>To build the container locally you can run</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo podman build --tag bootc-image-builder .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>NOTE: running already the <code>podman build</code> as root avoids problems later as we need to run the building
of the image as root anyway</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-the-system">Accessing the system<a href="#accessing-the-system" class="hash-link" aria-label="Direct link to Accessing the system" title="Direct link to Accessing the system">​</a></h3>
<p>With a virtual machine launched with the above <a href="#virt-install">virt-install</a> example, access the system with</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh -i /path/to/private/ssh-key alice@ip-address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that if you do not provide a password for the provided user, <code>sudo</code> will not work unless passwordless sudo
is configured. The base image <code>quay.io/centos-bootc/centos-bootc:stream9</code> does not configure passwordless sudo.
This can be configured in a derived bootc container by including the following in a Containerfile.</p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM quay.io/centos-bootc/centos-bootc:stream9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ADD wheel-passwordless-sudo /etc/sudoers.d/wheel-passwordless-sudo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The contents of the file <code>wheel-passwordless-sudo</code> should be</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">%wheel ALL=(ALL) NOPASSWD: ALL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reporting-bugs">Reporting bugs<a href="#reporting-bugs" class="hash-link" aria-label="Direct link to Reporting bugs" title="Direct link to Reporting bugs">​</a></h2>
<p>Please report bugs to the <a href="https://github.com/osbuild/bootc-image-builder/issues" target="_blank" rel="noopener noreferrer">Bug Tracker</a> and include instructions to reproduce and the output of:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo podman run --rm -it quay.io/centos-bootc/bootc-image-builder:latest version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contributing">Contributing<a href="#contributing" class="hash-link" aria-label="Direct link to Contributing" title="Direct link to Contributing">​</a></h3>
<p>Please refer to the <a href="https://www.osbuild.org/docs/developer-guide/index" target="_blank" rel="noopener noreferrer">developer guide</a> to learn about our
workflow, code style and more.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-repository">🗄️ Repository<a href="#️-repository" class="hash-link" aria-label="Direct link to 🗄️ Repository" title="Direct link to 🗄️ Repository">​</a></h2>
<ul>
<li><strong>web</strong>:   <a href="https://github.com/osbuild/bootc-image-builder" target="_blank" rel="noopener noreferrer">https://github.com/osbuild/bootc-image-builder</a></li>
<li><strong>https</strong>: <code>https://github.com/osbuild/bootc-image-builder.git</code></li>
<li><strong>ssh</strong>:   <code>git@github.com:osbuild/bootc-image-builder.git</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-project">📊 Project<a href="#-project" class="hash-link" aria-label="Direct link to 📊 Project" title="Direct link to 📊 Project">​</a></h2>
<ul>
<li><strong>Website</strong>: <a href="https://www.osbuild.org" target="_blank" rel="noopener noreferrer">https://www.osbuild.org</a></li>
<li><strong>Bug Tracker</strong>: <a href="https://github.com/osbuild/bootc-image-builder/issues" target="_blank" rel="noopener noreferrer">https://github.com/osbuild/bootc-image-builder/issues</a></li>
<li><strong>Discussions</strong>: <a href="https://github.com/orgs/osbuild/discussions" target="_blank" rel="noopener noreferrer">https://github.com/orgs/osbuild/discussions</a></li>
<li><strong>Matrix</strong>: <a href="https://matrix.to/#/#image-builder:fedoraproject.org" target="_blank" rel="noopener noreferrer">#image-builder on fedoraproject.org</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-license">🧾 License<a href="#-license" class="hash-link" aria-label="Direct link to 🧾 License" title="Direct link to 🧾 License">​</a></h2>
<ul>
<li><strong>Apache-2.0</strong></li>
<li>See LICENSE file for details.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/osbuild/bootc-image-builder/blob/main/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-installation" class="table-of-contents__link toc-highlight">🔨 Installation</a></li><li><a href="#-prerequisites" class="table-of-contents__link toc-highlight">✍ Prerequisites</a></li><li><a href="#-examples" class="table-of-contents__link toc-highlight">🚀 Examples</a><ul><li><a href="#running-the-resulting-qcow2-file-on-linux-x86_64" class="table-of-contents__link toc-highlight">Running the resulting QCOW2 file on Linux (x86_64)</a></li><li><a href="#running-the-resulting-qcow2-file-on-macos-aarch64" class="table-of-contents__link toc-highlight">Running the resulting QCOW2 file on macOS (aarch64)</a></li></ul></li><li><a href="#-arguments" class="table-of-contents__link toc-highlight">📝 Arguments</a><ul><li><a href="#detailed-description-of-optional-flags" class="table-of-contents__link toc-highlight">Detailed description of optional flags</a></li></ul></li><li><a href="#-image-types" class="table-of-contents__link toc-highlight">💾 Image types</a></li><li><a href="#-target-architecture" class="table-of-contents__link toc-highlight">💾 Target architecture</a></li><li><a href="#progress-types" class="table-of-contents__link toc-highlight">Progress types</a></li><li><a href="#️-cloud-uploaders" class="table-of-contents__link toc-highlight">☁️ Cloud uploaders</a><ul><li><a href="#amazon-machine-images-amis" class="table-of-contents__link toc-highlight">Amazon Machine Images (AMIs)</a></li></ul></li><li><a href="#-volumes" class="table-of-contents__link toc-highlight">💽 Volumes</a></li><li><a href="#-build-config" class="table-of-contents__link toc-highlight">📝 Build config</a><ul><li><a href="#users-user-array" class="table-of-contents__link toc-highlight">Users (<code>user</code>, array)</a></li><li><a href="#kernel-arguments-kernel-mapping" class="table-of-contents__link toc-highlight">Kernel Arguments (<code>kernel</code>, mapping)</a></li><li><a href="#filesystems-filesystem-array" class="table-of-contents__link toc-highlight">Filesystems (<code>filesystem</code>, array)</a></li><li><a href="#anaconda-iso-installer-options-installer-mapping" class="table-of-contents__link toc-highlight">Anaconda ISO (installer) options (<code>installer</code>, mapping)</a></li></ul></li><li><a href="#building" class="table-of-contents__link toc-highlight">Building</a><ul><li><a href="#accessing-the-system" class="table-of-contents__link toc-highlight">Accessing the system</a></li></ul></li><li><a href="#reporting-bugs" class="table-of-contents__link toc-highlight">Reporting bugs</a><ul><li><a href="#contributing" class="table-of-contents__link toc-highlight">Contributing</a></li></ul></li><li><a href="#️-repository" class="table-of-contents__link toc-highlight">🗄️ Repository</a></li><li><a href="#-project" class="table-of-contents__link toc-highlight">📊 Project</a></li><li><a href="#-license" class="table-of-contents__link toc-highlight">🧾 License</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/orgs/osbuild/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://matrix.to/#/#image-builder:fedoraproject.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/osbuild/osbuild.github.io/commits/43c7c63b983517bf87b37a561ba6f4e935a62a01" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Red Hat, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>