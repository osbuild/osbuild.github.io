<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developer-guide/projects/image-builder-frontend/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Image Builder Frontend | Image Builder</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://osbuild.org/docs/developer-guide/projects/image-builder-frontend/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Image Builder Frontend | Image Builder"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://osbuild.org/docs/developer-guide/projects/image-builder-frontend/"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/developer-guide/projects/image-builder-frontend/" hreflang="en"><link data-rh="true" rel="alternate" href="https://osbuild.org/docs/developer-guide/projects/image-builder-frontend/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2d858f81.css">
<script src="/assets/js/runtime~main.52db5e0f.js" defer="defer"></script>
<script src="/assets/js/main.853c34f9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="osbuild logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Image Builder</b></a><a class="navbar__item navbar__link" href="/docs/hosted/architecture/">Hosted</a><a class="navbar__item navbar__link" href="/docs/on-premises/overview/">On Premises</a><a class="navbar__item navbar__link" href="/docs/bootc/">Bootc</a><a class="navbar__item navbar__link" href="/docs/user-guide/introduction/">User Guide</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/developer-guide/index/">Developer Guide</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/developer-guide/index/">Developer Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/developer-guide/general/">General Topics</a><button aria-label="Expand sidebar category &#x27;General Topics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/developer-guide/projects/">Project Overview</a><button aria-label="Collapse sidebar category &#x27;Project Overview&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/composer-cli/">composer-cli</a><button aria-label="Expand sidebar category &#x27;composer-cli&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/image-builder/">image-builder</a><button aria-label="Expand sidebar category &#x27;image-builder&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/image-builder-crc/">Image Builder console.redhat.com Middleware</a><button aria-label="Expand sidebar category &#x27;Image Builder console.redhat.com Middleware&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developer-guide/projects/image-builder-frontend/">Image Builder Frontend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/images/">Images</a><button aria-label="Expand sidebar category &#x27;Images&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/koji-image-builder/">koji-image-builder</a><button aria-label="Expand sidebar category &#x27;koji-image-builder&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/osbuild/">OSBuild</a><button aria-label="Expand sidebar category &#x27;OSBuild&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/developer-guide/projects/osbuild-composer/">OSBuild Composer</a><button aria-label="Expand sidebar category &#x27;OSBuild Composer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/projects/rpmrepo/">RPMrepo Snapshots</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/developer-guide/projects/"><span itemprop="name">Project Overview</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Image Builder Frontend</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Image Builder Frontend</h1></header>
<p>Frontend code for Image Builder.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="project">Project<a href="#project" class="hash-link" aria-label="Direct link to Project" title="Direct link to Project">​</a></h2>
<ul>
<li><strong>Website</strong>: <a href="https://www.osbuild.org" target="_blank" rel="noopener noreferrer">https://www.osbuild.org</a></li>
<li><strong>Bug Tracker</strong>: <a href="https://github.com/osbuild/image-builder-frontend/issues" target="_blank" rel="noopener noreferrer">https://github.com/osbuild/image-builder-frontend/issues</a></li>
<li><strong>Discussions</strong>: <a href="https://github.com/orgs/osbuild/discussions" target="_blank" rel="noopener noreferrer">https://github.com/orgs/osbuild/discussions</a></li>
<li><strong>Matrix</strong>: #image-builder on <a href="https://matrix.to/#/#image-builder:fedoraproject.org" target="_blank" rel="noopener noreferrer">fedoraproject.org</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="principles">Principles<a href="#principles" class="hash-link" aria-label="Direct link to Principles" title="Direct link to Principles">​</a></h2>
<ol>
<li>We want to use the latest and greatest web technologies.</li>
<li>We want to expose all the options and customizations possible, even if not all are visible by default.</li>
<li>The default path should be ‘short(est)’ clickpath, which should be determined in a data-driven way.</li>
<li>This is an <a href="https://github.com/RedHatInsights/" target="_blank" rel="noopener noreferrer">Insights application</a>, so it abides by some rules and standards of Insights.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2>
<ol>
<li><a href="#frontend-development">How to build and run image-builder-frontend</a>
<ol>
<li><a href="#frontend-development">Frontend Development</a></li>
<li><a href="#image-builder-as-cockpit-plugin">Image builder as Cockpit plugin</a></li>
<li><a href="#backend-development">Backend Development</a></li>
</ol>
</li>
<li><a href="#api-endpoints">API endpoints</a>
<ol>
<li><a href="#add-a-new-api-schema">Add a new API schema</a></li>
<li><a href="#add-a-new-endpoint">Add a new endpoint</a></li>
</ol>
</li>
<li><a href="#unleash-feature-flags">Unleash feature flags</a>
<ol>
<li><a href="#mocking-flags-for-tests">Mocking flags for tests</a></li>
<li><a href="#cleaning-the-flags">Cleaning the flags</a></li>
</ol>
</li>
<li><a href="#file-structure">File Structure</a></li>
<li><a href="#style-guidelines">Style Guidelines</a></li>
<li><a href="#test-guidelines">Test Guidelines</a></li>
<li><a href="#running-hosted-service-playwright-tests">Running hosted service Playwright tests</a></li>
<li><a href="#playwright-boot-tests">Playwright Boot tests</a>
<ol>
<li><a href="#local-development-setup">Local development setup</a></li>
<li><a href="#ci-setup">CI setup</a></li>
</ol>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-build-and-run-image-builder-frontend">How to build and run image-builder-frontend<a href="#how-to-build-and-run-image-builder-frontend" class="hash-link" aria-label="Direct link to How to build and run image-builder-frontend" title="Direct link to How to build and run image-builder-frontend">​</a></h2>
<blockquote>
<p>[!IMPORTANT]
Running image-builder-frontend against <a href="https://console.redhat.com/" target="_blank" rel="noopener noreferrer">console.redhat.com</a> requires connection to the Red Hat VPN, which is only available to Red Hat employees. External contributors can locally run <a href="#image-builder-as-cockpit-plugin">image builder as Cockpit plugin</a>.</p>
<p>As you will see in the following sections we <strong>always</strong> prefer <code>npm clean-install</code> (aka <code>npm ci</code>) over <code>npm install</code> to install dependencies exactly as they are defined in the <code>package-lock.json</code> file.<br>
This is crucial to avoid any discrepancies between the dependencies installed locally and the dependencies installed in the CI as well as unintentionally installing compromised dependencies.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="frontend-development">Frontend Development<a href="#frontend-development" class="hash-link" aria-label="Direct link to Frontend Development" title="Direct link to Frontend Development">​</a></h3>
<p>To develop the frontend you can use a proxy to run image-builder-frontend locally
against the chrome and backend at console.redhat.com.</p>
<p>Working against the production environment is preferred, as any work can be released without
worrying if a feature from stage has been released yet.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="nodejs-and-npm-version">Nodejs and npm version<a href="#nodejs-and-npm-version" class="hash-link" aria-label="Direct link to Nodejs and npm version" title="Direct link to Nodejs and npm version">​</a></h4>
<p>Make sure you have npm@10 and node 22+ installed. If you need multiple versions of nodejs check out <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener noreferrer">nvm</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="webpack-proxy">Webpack proxy<a href="#webpack-proxy" class="hash-link" aria-label="Direct link to Webpack proxy" title="Direct link to Webpack proxy">​</a></h4>
<ol>
<li>
<p>run <code>npm clean-install</code></p>
</li>
<li>
<p>run <code>npm run start:prod</code></p>
</li>
<li>
<p>redirect <code>prod.foo.redhat.com</code> to localhost, if this has not been done already</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;127.0.0.1 prod.foo.redhat.com&quot; &gt;&gt; /etc/hosts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>open browser at <code>https://prod.foo.redhat.com:1337/beta/insights/image-builder</code></li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="webpack-proxy-staging----runs-with-image-builders-stage-deployment">Webpack proxy (staging) -- <em>Runs with image-builder&#x27;s stage deployment</em><a href="#webpack-proxy-staging----runs-with-image-builders-stage-deployment" class="hash-link" aria-label="Direct link to webpack-proxy-staging----runs-with-image-builders-stage-deployment" title="Direct link to webpack-proxy-staging----runs-with-image-builders-stage-deployment">​</a></h4>
<ol>
<li>
<p>run <code>npm clean-install</code></p>
</li>
<li>
<p>run <code>npm run start:stage</code></p>
</li>
<li>
<p>redirect <code>stage.foo.redhat.com</code> to localhost, if this has not been done already</p>
</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;127.0.0.1 stage.foo.redhat.com&quot; &gt;&gt; /etc/hosts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>open browser at <code>https://stage.foo.redhat.com:1337/beta/insights/image-builder</code></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="image-builder-as-cockpit-plugin">Image builder as Cockpit plugin<a href="#image-builder-as-cockpit-plugin" class="hash-link" aria-label="Direct link to Image builder as Cockpit plugin" title="Direct link to Image builder as Cockpit plugin">​</a></h3>
<blockquote>
<p>[!NOTE]
Issues marked with <a href="https://github.com/osbuild/image-builder-frontend/issues?q=is%3Aissue%20state%3Aopen%20label%3Acockpit-image-builder" target="_blank" rel="noopener noreferrer">cockpit-image-builder</a> label are reproducible in image builder plugin and can be worked on by external contributors without connection to the Red Hat VPN.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cockpit-setup">Cockpit setup<a href="#cockpit-setup" class="hash-link" aria-label="Direct link to Cockpit setup" title="Direct link to Cockpit setup">​</a></h4>
<p>To install and setup Cockpit follow guide at: <a href="https://cockpit-project.org/running.html" target="_blank" rel="noopener noreferrer">https://cockpit-project.org/running.html</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="on-premises-image-builder-installation-and-configuration">On-premises image builder installation and configuration<a href="#on-premises-image-builder-installation-and-configuration" class="hash-link" aria-label="Direct link to On-premises image builder installation and configuration" title="Direct link to On-premises image builder installation and configuration">​</a></h4>
<p>To install and configure <code>osbuild-composer</code> on your local machine follow our documentation: <a href="https://osbuild.org/docs/on-premises/installation/" target="_blank" rel="noopener noreferrer">https://osbuild.org/docs/on-premises/installation/</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="scripts-for-local-development-of-image-builder-plugin">Scripts for local development of image builder plugin<a href="#scripts-for-local-development-of-image-builder-plugin" class="hash-link" aria-label="Direct link to Scripts for local development of image builder plugin" title="Direct link to Scripts for local development of image builder plugin">​</a></h4>
<p>The following scripts are used to build the frontend with Webpack and install it into the Cockpit directories. These scripts streamline the development process by automating build and installation steps.</p>
<p>Runs Webpack with the specified configuration (cockpit/webpack.config.ts) to build the frontend assets.
Use this command whenever you need to compile the latest changes in your frontend code.</p>
<p>Creates the necessary directory in the user&#x27;s local Cockpit share (~/.local/share/cockpit/).
Creates a symbolic link (image-builder-frontend) pointing to the built frontend assets (cockpit/public).
Use this command after building the frontend to install it locally for development purposes.
The symbolic link allows Cockpit to serve the frontend assets from your local development environment,
making it easier to test changes in real-time without deploying to a remote server.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make cockpit/build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make cockpit/devel-install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To uninstall and remove the symbolic link, run the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make cockpit/devel-uninstall</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For convenience, you can run the following to combine all three steps:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make cockpit/devel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backend-development">Backend Development<a href="#backend-development" class="hash-link" aria-label="Direct link to Backend Development" title="Direct link to Backend Development">​</a></h3>
<p>To develop both the frontend and the backend you can again use the proxy to run both the
frontend and backend locally against the chrome at cloud.redhat.com. For instructions
see the <a href="https://github.com/osbuild/osbuild-getting-started" target="_blank" rel="noopener noreferrer">osbuild-getting-started project</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-endpoints">API endpoints<a href="#api-endpoints" class="hash-link" aria-label="Direct link to API endpoints" title="Direct link to API endpoints">​</a></h2>
<p>API slice definitions are programmatically generated using the <a href="https://redux-toolkit.js.org/rtk-query/usage/code-generation" target="_blank" rel="noopener noreferrer">@rtk-query/codegen-openapi</a> package.</p>
<p>The OpenAPI schema are imported during code generation. OpenAPI configuration files are
stored in <code>/api/config</code>. Each endpoint has a corresponding empty API slice and generated API
slice which are stored in <code>/src/store</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-new-api-schema">Add a new API schema<a href="#add-a-new-api-schema" class="hash-link" aria-label="Direct link to Add a new API schema" title="Direct link to Add a new API schema">​</a></h3>
<p>For a hypothetical API called foobar</p>
<ol>
<li>Create a new &quot;empty&quot; API file under <code>src/store/emptyFoobarApi.ts</code> that has following
content:</li>
</ol>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> createApi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fetchBaseQuery </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@reduxjs/toolkit/query/react&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">FOOBAR_API</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;../constants&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// initialize an empty api service that we&#x27;ll inject endpoints into later as needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> emptyFoobarApi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createApi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  reducerPath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foobarApi&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseQuery</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetchBaseQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> baseUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">location</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">origin </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">FOO_BAR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">endpoints</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Declare new constant <code>FOOBAR_API</code> with the API url in <code>src/constants.ts</code></li>
</ol>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">FOOBAR_API</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;api/foobar/v1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>Create the config file for code generation in <code>api/config/foobar.ts</code> containing:</li>
</ol>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> ConfigFile </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@rtk-query/codegen-openapi&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> config</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ConfigFile </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  schemaFile</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;URL_TO_THE_OPENAPI_SCHEMA&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apiFile</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;../../src/store/emptyFoobarApi.ts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apiImport</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;emptyContentSourcesApi&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  outputFile</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;../../src/store/foobarApi.ts&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  exportName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foobarApi&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hooks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filterEndpoints</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;getFoo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;getBar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;getFoobar&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Update the <code>eslint.config.js</code> file by adding the generated code path to the ignores array:</li>
</ol>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ignores: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &lt;other ignored files&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;**/foobarApi.ts&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="5">
<li>run api generation</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run api</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And voilà!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-new-endpoint">Add a new endpoint<a href="#add-a-new-endpoint" class="hash-link" aria-label="Direct link to Add a new endpoint" title="Direct link to Add a new endpoint">​</a></h3>
<p>To add a new endpoint, simply update the <code>api/config/foobar.ts</code> file with new
endpoints in the <code>filterEndpoints</code> table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="unleash-feature-flags">Unleash feature flags<a href="#unleash-feature-flags" class="hash-link" aria-label="Direct link to Unleash feature flags" title="Direct link to Unleash feature flags">​</a></h2>
<p>Your user needs to have the corresponding rights, do the
same as this MR in internal gitlab <a href="https://gitlab.cee.redhat.com/service/app-interface/-/merge_requests/79225" target="_blank" rel="noopener noreferrer">https://gitlab.cee.redhat.com/service/app-interface/-/merge_requests/79225</a>
you can ask on the slack channel <a href="https://redhat-internal.slack.com/archives/C023YSA47A4" target="_blank" rel="noopener noreferrer">https://redhat-internal.slack.com/archives/C023YSA47A4</a> for a merge if your MR stays unchecked for a little while.</p>
<p>Then connect to the following platforms:</p>
<ul>
<li><a href="https://insights-stage.unleash.devshift.net/" target="_blank" rel="noopener noreferrer">https://insights-stage.unleash.devshift.net/</a> for stage</li>
<li><a href="https://insights.unleash.devshift.net" target="_blank" rel="noopener noreferrer">https://insights.unleash.devshift.net</a> prod</li>
</ul>
<p>Once you have a toggle to work with, on the frontend code there&#x27;s just need to
import the <code>useFlag</code> hook and to use it. You can get some inspiration from
existing flags:</p>
<p><a href="https://github.com/RedHatInsights/image-builder-frontend/blob/c84b493eba82ce83a7844943943d91112ffe8322/src/Components/ImagesTable/ImageLink.js#L99" target="_blank" rel="noopener noreferrer">https://github.com/RedHatInsights/image-builder-frontend/blob/c84b493eba82ce83a7844943943d91112ffe8322/src/Components/ImagesTable/ImageLink.js#L99</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mocking-flags-for-tests">Mocking flags for tests<a href="#mocking-flags-for-tests" class="hash-link" aria-label="Direct link to Mocking flags for tests" title="Direct link to Mocking flags for tests">​</a></h3>
<p>Flags can be mocked for the unit tests to access some feature. Checkout:
<a href="https://github.com/osbuild/image-builder-frontend/blob/9a464e416bc3769cfc8e23b62f1dd410eb0e0455/src/test/Components/CreateImageWizard/CreateImageWizard.test.tsx#L49" target="_blank" rel="noopener noreferrer">https://github.com/osbuild/image-builder-frontend/blob/9a464e416bc3769cfc8e23b62f1dd410eb0e0455/src/test/Components/CreateImageWizard/CreateImageWizard.test.tsx#L49</a></p>
<p>If the two possible code path accessible via the toggles are defined in the code
base, then it&#x27;s good practice to test the two of them. If not, only test what&#x27;s
actually owned by the frontend project.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cleaning-the-flags">Cleaning the flags<a href="#cleaning-the-flags" class="hash-link" aria-label="Direct link to Cleaning the flags" title="Direct link to Cleaning the flags">​</a></h3>
<p>Unleash toggles are expected to live for a limited amount of time, documentation
specify 40 days for a release, we should keep that in mind for each toggle
we&#x27;re planning on using.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="file-structure">File Structure<a href="#file-structure" class="hash-link" aria-label="Direct link to File Structure" title="Direct link to File Structure">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="quick-reference">Quick Reference<a href="#quick-reference" class="hash-link" aria-label="Direct link to Quick Reference" title="Direct link to Quick Reference">​</a></h3>
<table><thead><tr><th>Directory</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/api/" target="_blank" rel="noopener noreferrer"><code>/api</code></a></td><td>API schema and config files</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/config/" target="_blank" rel="noopener noreferrer"><code>/config</code></a></td><td>webpack configuration</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/src/" target="_blank" rel="noopener noreferrer"><code>/src</code></a></td><td>source code</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/src/Components/" target="_blank" rel="noopener noreferrer"><code>/src/Components</code></a></td><td>source code split by individual components</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright/" target="_blank" rel="noopener noreferrer"><code>/playwright</code></a></td><td>Playwright tests</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright/BootTests/" target="_blank" rel="noopener noreferrer"><code>/playwright/BootTests</code></a></td><td>Playwright boot tests</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/src/test/" target="_blank" rel="noopener noreferrer"><code>/src/test</code></a></td><td>vitest utilities</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/src/test/mocks/" target="_blank" rel="noopener noreferrer"><code>/src/test/mocks</code></a></td><td>mock handlers and server config for MSW</td></tr><tr><td><a href="https://github.com/osbuild/image-builder-frontend/tree/main/src/store/" target="_blank" rel="noopener noreferrer"><code>/src/store</code></a></td><td>Redux store</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="style-guidelines">Style Guidelines<a href="#style-guidelines" class="hash-link" aria-label="Direct link to Style Guidelines" title="Direct link to Style Guidelines">​</a></h2>
<p>This project uses recommended rule sets rom several plugins:</p>
<ul>
<li><code>@eslint/js</code></li>
<li><code>typescript-eslint</code></li>
<li><code>eslint-plugin-react</code></li>
<li><code>eslint-plugin-react-hooks</code></li>
<li><code>eslint-plugin-react-redux</code></li>
<li><code>eslint-plugin-import</code></li>
<li><code>eslint-plugin-jsx-a11y</code></li>
<li><code>eslint-plugin-disable-autofix</code></li>
<li><code>eslint-plugin-jest-dom</code></li>
<li><code>eslint-plugin-testing-library</code></li>
<li><code>eslint-plugin-playwright</code></li>
<li><code>@redhat-cloud-services/eslint-config-redhat-cloud-services</code></li>
</ul>
<p>To run the linter, use:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run lint</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Any errors that can be fixed automatically, can be corrected by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run lint:js:fix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All the linting rules and configuration of ESLint can be found in <a href="https://github.com/osbuild/image-builder-frontend/tree/main/eslint.config.js" target="_blank" rel="noopener noreferrer"><code>eslint.config.js</code></a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-guidelines">Test Guidelines<a href="#test-guidelines" class="hash-link" aria-label="Direct link to Test Guidelines" title="Direct link to Test Guidelines">​</a></h2>
<p>This project is tested using the <a href="https://vitest.dev/guide/" target="_blank" rel="noopener noreferrer">Vitest</a> framework, <a href="https://testing-library.com/docs/react-testing-library/intro" target="_blank" rel="noopener noreferrer">React Testing Library</a>, and the <a href="https://mswjs.io/docs/" target="_blank" rel="noopener noreferrer">Mock Service Worker</a> library.</p>
<p>All UI contributions must also include a new test or update an existing test in order to maintain code coverage.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-tests">Running the tests<a href="#running-the-tests" class="hash-link" aria-label="Direct link to Running the tests" title="Direct link to Running the tests">​</a></h3>
<p>To run the unit tests, the linter, and the code coverage check run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These tests will also be run in our CI when a PR is opened.</p>
<p>Note that <code>testing-library</code> DOM printout is currently disabled for all tests by the following configuration in <code>src/test/setup.ts</code>:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">configure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">getElementError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> error </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;TestingLibraryElementError&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stack </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you&#x27;d like to see the stack printed out you can either temporarily disable the configuration or generate a <a href="https://testing-playground.com/" target="_blank" rel="noopener noreferrer">Testing Playground</a> link by adding <code>screen.logTestingPlaygroundURL()</code> to your test.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-hosted-service-playwright-tests">Running hosted service Playwright tests<a href="#running-hosted-service-playwright-tests" class="hash-link" aria-label="Direct link to Running hosted service Playwright tests" title="Direct link to Running hosted service Playwright tests">​</a></h2>
<p>Hosted service Playwright tests provide test coverage of UI components in our service hosted at <a href="https://console.redhat.com/" target="_blank" rel="noopener noreferrer">console.redhat.com</a> (currently only in stage environment). We mainly use them to test the Wizard and other parts of the UI.
The tests are located in the <a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright/" target="_blank" rel="noopener noreferrer">playwright/</a> directory and are identified by the <code>*.spec.ts</code> file extension.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-tests">Running tests<a href="#running-tests" class="hash-link" aria-label="Direct link to Running tests" title="Direct link to Running tests">​</a></h3>
<ol>
<li>
<p>Copy the <a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright_example.env" target="_blank" rel="noopener noreferrer">example env file</a> content and create a file named <code>.env</code> in the root directory of the project. Paste the example file content into it.
For local development fill in the:</p>
<ul>
<li><code>BASE_URL</code> - <code>https://stage.foo.redhat.com:1337</code> is required, which is already set in the example config</li>
<li><code>PLAYWRIGHT_USER</code> - your consoledot stage username</li>
<li><code>PLAYWRIGHT_PASSWORD</code> - your consoledot stage password</li>
</ul>
</li>
<li>
<p>Make sure Playwright is installed as a dev dependency</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm clean-install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Download the Playwright browsers with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npx playwright install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Start the local development stage server by running</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run start:stage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Now you have two options of how to run the tests:</p>
<ul>
<li>(Preferred) Use VS Code and the <a href="https://marketplace.visualstudio.com/items?itemName=ms-playwright.playwright" target="_blank" rel="noopener noreferrer">Playwright Test module for VSCode</a>. But other editors do have similar plugins for ease of use, if so desired</li>
<li>Using terminal - <code>npx playwright test</code> will run the playwright test suite. <code>npx playwright test --headed</code> will run the suite in a vnc-like browser so you can watch it&#x27;s interactions.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-vs-static-users">Dynamic vs static users<a href="#dynamic-vs-static-users" class="hash-link" aria-label="Direct link to Dynamic vs static users" title="Direct link to Dynamic vs static users">​</a></h3>
<p>This applies to the <strong>stage</strong> environment only. By default we generate a new user for each CI run for the hosted tests, however there is an option to use static user as well. You can set credentials for said static user like this:</p>
<div class="language-.env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-.env codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PLAYWRIGHT_STATIC_USER=&quot;&lt;your_static_user_username&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLAYWRIGHT_STATIC_PASSWORD=&quot;&lt;your_static_user_password&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For local development purposes, you can use the same credentials as for <code>PLAYWRIGHT_USER</code> and <code>PLAYWRIGHT_PASSWORD</code> if you are using your stage account for those.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="playwright-boot-tests">Playwright Boot tests<a href="#playwright-boot-tests" class="hash-link" aria-label="Direct link to Playwright Boot tests" title="Direct link to Playwright Boot tests">​</a></h2>
<p>This section describes what Playwright Boot tests are, how they work and how to run them locally.</p>
<p>Boot tests provide end to end coverage for Image Builder and they are used to test mainly integrations with other services. Their main advantage is that they build an image, upload it and <strong>launch it on RHOSP</strong> (RedHat OpenStack Platform). This way we can test images and their customizations through remotely executed commands on an actual running VM booted from the image.
Boot tests are located in the <a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright/BootTests" target="_blank" rel="noopener noreferrer">playwright/BootTests</a> directory and are identified by the <code>*.boot.ts</code> file extension.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="local-development-setup">Local development setup<a href="#local-development-setup" class="hash-link" aria-label="Direct link to Local development setup" title="Direct link to Local development setup">​</a></h3>
<p>In order to run the Boot tests locally, we need to set up few things first on top of what we did in the <a href="#running-hosted-service-playwright-tests">Running hosted service Playwright tests</a> section.</p>
<p>We need additional fields in the .env file, some of them are already set and don&#x27;t need to be changed in the <a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright_example.env" target="_blank" rel="noopener noreferrer">example env file</a>), but some of them have to be set manually, specifically following:</p>
<div class="language-.env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-.env codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OS_APPLICATION_CREDENTIAL_ID=&lt;your_id&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS_APPLICATION_CREDENTIAL_SECRET=&lt;your_secret&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS_SSH_KEY_NAME=&quot;&lt;name_of_your_ssh_key_entry_in_openstack&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>[!NOTE]
The OpenStack Client is required for boot tests to function properly.</p>
</blockquote>
<p>In order to be able to access RHOSP within the Boot tests, we need to generate credentials and create an entry with our public ssh key on the platform. Log into <a href="https://api.rhos-01.prod.psi.rdu2.redhat.com/" target="_blank" rel="noopener noreferrer">RHOSP dashboard</a> using <strong>Keystone credentials</strong> and navigate to Identity -&gt; Application Credentials. There you can create the credentials (you will get values for <code>OS_APPLICATION_CREDENTIAL_ID</code> and <code>OS_APPLICATION_CREDENTIAL_SECRET</code>). In order to create an entry for your SSH key, navigate to Project -&gt; Compute -&gt; Keys and add your public key there.</p>
<p>By filling out these variables you should be able to run the Boot test locally successfully.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ci-setup">CI setup<a href="#ci-setup" class="hash-link" aria-label="Direct link to CI setup" title="Direct link to CI setup">​</a></h3>
<p>Boot tests run as a scheduled nightly Github Action with a custom runner in AWS Codebuild, but there is an option to run them manually on a PR as well.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="automated-run">Automated run<a href="#automated-run" class="hash-link" aria-label="Direct link to Automated run" title="Direct link to Automated run">​</a></h4>
<p>Boot tests run automatically on PRs when they contain changes inside the <a href="https://github.com/osbuild/image-builder-frontend/tree/main/playwright/BootTests" target="_blank" rel="noopener noreferrer">playwright/BootTests</a> directory.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manual-run">Manual run<a href="#manual-run" class="hash-link" aria-label="Direct link to Manual run" title="Direct link to Manual run">​</a></h4>
<p>In order to run the Boot tests on a PR, you can open the <code>Boot tests</code> workflow in Github Actions and type in the number of PR into a <code>Pull Request number to run tests against</code> field. The action will then pull the code from a PR of that number and execute as usual.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="where-can-i-see-results">Where can I see results?<a href="#where-can-i-see-results" class="hash-link" aria-label="Direct link to Where can I see results?" title="Direct link to Where can I see results?">​</a></h4>
<p>You can find artifacts and link to a Currents report directly in the workflow run detail, but Currents will also link the report back to the PR when the workflow finishes as a <em>check</em>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/osbuild/image-builder-frontend/blob/main/README.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developer-guide/projects/image-builder-crc/HACKING/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Image Builder contributing guide</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developer-guide/projects/images/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Images</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project" class="table-of-contents__link toc-highlight">Project</a></li><li><a href="#principles" class="table-of-contents__link toc-highlight">Principles</a></li><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#how-to-build-and-run-image-builder-frontend" class="table-of-contents__link toc-highlight">How to build and run image-builder-frontend</a><ul><li><a href="#frontend-development" class="table-of-contents__link toc-highlight">Frontend Development</a></li><li><a href="#image-builder-as-cockpit-plugin" class="table-of-contents__link toc-highlight">Image builder as Cockpit plugin</a></li><li><a href="#backend-development" class="table-of-contents__link toc-highlight">Backend Development</a></li></ul></li><li><a href="#api-endpoints" class="table-of-contents__link toc-highlight">API endpoints</a><ul><li><a href="#add-a-new-api-schema" class="table-of-contents__link toc-highlight">Add a new API schema</a></li><li><a href="#add-a-new-endpoint" class="table-of-contents__link toc-highlight">Add a new endpoint</a></li></ul></li><li><a href="#unleash-feature-flags" class="table-of-contents__link toc-highlight">Unleash feature flags</a><ul><li><a href="#mocking-flags-for-tests" class="table-of-contents__link toc-highlight">Mocking flags for tests</a></li><li><a href="#cleaning-the-flags" class="table-of-contents__link toc-highlight">Cleaning the flags</a></li></ul></li><li><a href="#file-structure" class="table-of-contents__link toc-highlight">File Structure</a><ul><li><a href="#quick-reference" class="table-of-contents__link toc-highlight">Quick Reference</a></li></ul></li><li><a href="#style-guidelines" class="table-of-contents__link toc-highlight">Style Guidelines</a></li><li><a href="#test-guidelines" class="table-of-contents__link toc-highlight">Test Guidelines</a><ul><li><a href="#running-the-tests" class="table-of-contents__link toc-highlight">Running the tests</a></li></ul></li><li><a href="#running-hosted-service-playwright-tests" class="table-of-contents__link toc-highlight">Running hosted service Playwright tests</a><ul><li><a href="#running-tests" class="table-of-contents__link toc-highlight">Running tests</a></li><li><a href="#dynamic-vs-static-users" class="table-of-contents__link toc-highlight">Dynamic vs static users</a></li></ul></li><li><a href="#playwright-boot-tests" class="table-of-contents__link toc-highlight">Playwright Boot tests</a><ul><li><a href="#local-development-setup" class="table-of-contents__link toc-highlight">Local development setup</a></li><li><a href="#ci-setup" class="table-of-contents__link toc-highlight">CI setup</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/orgs/osbuild/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://matrix.to/#/#image-builder:fedoraproject.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/osbuild/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/osbuild/osbuild.github.io/commits/fcddd5cc00978271c4057c874a747b15818d44c3" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Red Hat, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>